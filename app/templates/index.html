<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <script src="static/plotly_min.js"></script>
        <script src="static/d3.min.js"></script>
    </head>
    <body>
    <div class="wrapper">
        <div id="chart"></div>
        <script>
            Plotly.d3.csv('static/data_x.csv', function(err,rows) {
                var data_x = [];
                for(let i=0;i<rows.length;i++) {
                    data_x.push(rows.map(row => row [i]));
                }
                Plotly.d3.csv('static/data_y.csv', function(err,rows) {
                    var data_y = [];
                    for(let i=0;i<rows.length;i++) {
                        data_y.push(rows.map(row => row [i]));
                    }
                    Plotly.d3.csv('static/data_z.csv', function(err,rows) {
                        var data_z = [];
                        for (let i = 0; i < rows.length; i++) {
                            data_z.push(rows.map(row => row [i]));
                        }
                        let min = 0;
                        let max = 10e6;
                        for (let i = 0; i < data_z.length; i++){
                            for (let j = 0; j < data_z[i].length; j++){
                                if (!(typeof data_z[i][j] === undefined)){
                                    console.log(1);
                                    min = Math.min(min, data_z[i][j]);
                                    max = Math.max(max, data_z[i][j]);
                                }
                            }
                        }
                        console.log(min, max);
                        for (let i = 0; i < data_z.length; i++) {
                            data_z[i] = data_z[i].map(el => el - min + (max - min) / 5);
                        }

                        let data = [{
                            x: data_x,
                            y: data_y,
                            z: data_z,
                            type: 'surface'
                        }, {
                            x: [Math.max(...data_x[0])],
                            y: [Math.max(...data_x[0])],
                            z: [Math.max(...data_x[0]) / 2],
                            type: 'scatter3d',
                            opacity: 0
                            }
                        ];

                        // let layout = {
                        //   title: 'Landscape',
                        //   xaxis: {
                        //     title: 'X',
                        //     showgrid: false,
                        //     zeroline: false
                        //   },
                        //   yaxis: {
                        //     title: 'Y',
                        //     showline: false
                        //   }
                        // };

                        Plotly.plot('chart', data);
                    })
                })
            })
        </script>
    </div>
    </body>
</html>